package jbof.gui.window.classes.style.mdi;

import java.net.*;
import java.util.*;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.event.*;

import com.borland.jbcl.layout.*;
import com.pansoft.pub.comp.*;
import jbof.application.classes.*;
import jbof.gui.window.classes.*;
import jbof.gui.window.classes.style.mdi.imp.*;
import jcomponent.custom.swing.*;
import jfoundation.bridge.classes.*;
import jframework.foundation.classes.*;
import jframework.resource.classes.*;
import jframework.log.JLogManager;
import com.pansoft.swing.tablepane.*;
import jfoundation.object.classes.*;

/**
 * <p>Title: Java Framework</p>
 * <p>Description: </p>
 * <p>Copyright: Copyright (c) 2002</p>
 * <p>Company: </p>
 * @author Skyline
 * @version 1.0
 */
//--------------------------------------------------------------------------------------------------
//é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
//é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.04.22)
//å®é”Ÿæ–¤æ‹·: Skyline
//é”Ÿç«é©æ‹·:
//--------------------------------------------------------------------------------------------------
public class JBOFMDIMainWindow extends JBOFMainWindow implements ActionListener, ChangeListener, WindowListener, MouseListener, Runnable, IObjectStatusChange, CloseListener, com.pansoft.swing.tablepane.PopupMenuListener {
  static ResourceBundle mPublicStrings = null;

  public Vector                   MenuList = new Vector();

  public Vector                   PopupMenuList = new Vector();
  public Vector                   ToolbarList = new Vector();
  public JWaitThread WaitThread = null;
//  public JBOFToolBar MainToolBar = new JBOFToolBar(1);
  public JBOFToolBar MainToolBar = null;

  public JBOFMDIChildWindow CurrentChildWindow = null;

  public JPanel contentPane = new JPanel();
  public BorderLayout MainborderLayout = new BorderLayout();
  public JMenuBar MainMenu = new JMenuBar();

  public com.jidesoft.swing.JideMenu mnFile   = null;
  public com.jidesoft.swing.JideMenu mnEdit   = null;
  public com.jidesoft.swing.JideMenu mnView   = null;
  public com.jidesoft.swing.JideMenu mnToolbar= null;
  public com.jidesoft.swing.JideMenu mnTools  = null;
  public com.jidesoft.swing.JideMenu mnWindow = null;
  public com.jidesoft.swing.JideMenu mnHelp   = null;
  public JMenuItem mnStatus = null;
  public JMenuItem mnMainToolbar = null;
  ImageIcon CloseImageIcon = null;

  Vector WindowMenuList = new Vector();
  Vector ToolbarMenuList= new Vector();


  public CloseAndMaxTabbedPane MainTabbedPane = new CloseAndMaxTabbedPane(true);
  javax.swing.JPopupMenu.Separator MenuSp   = new javax.swing.JPopupMenu.Separator();
  TitledBorder titledBorder1;
  JPopupMenu TablePopupMenu = new JPopupMenu();
  JPanel pnToolbar = new JPanel();
//  public Font MenuFont        = new java.awt.Font("dialog", 0, 12);
  private JPanel pnBottom = new JPanel();
  BorderLayout borderLayout1 = new BorderLayout();
  VerticalFlowLayout verticalFlowLayout1 = new VerticalFlowLayout();
  JPanel pnToolbar2 = new JPanel();
  JPanel pnToolbar1 = new JPanel();
  FlowLayout flowLayout1 = new FlowLayout();
  FlowLayout flowLayout2 = new FlowLayout();

  JPanel pnToolbar3 = new JPanel();
  FlowLayout flowLayout5 = new FlowLayout();
  JPanel pnStatus = new JPanel();
  BorderLayout borderLayout4 = new BorderLayout();
  JProgressBar pbProgressBar = new JProgressBar();
  JPanel pnBottom2 = new JPanel();
  JPanel pnBottom12 = new JPanel();
  JPanel pnBottom11 = new JPanel();
//  javax.swing.JToggleButton bnOffline = new javax.swing.JToggleButton();
  JPanel pnBottom1 = new JPanel();
  JLabel statusLabel1 = new JLabel();
  BorderLayout borderLayout2 = new BorderLayout();
  BorderLayout borderLayout3 = new BorderLayout();
  BorderLayout borderLayout5 = new BorderLayout();
  JPanel jPanel1 = new JPanel();
  JLabel statusLabel2 = new JLabel();
  BorderLayout borderLayout6 = new BorderLayout();
  JLabel statusLabel3 = new JLabel();
  JPanel jPanel2 = new JPanel();
  JLabel statusLabel4 = new JLabel();
  BorderLayout borderLayout7 = new BorderLayout();
  JCheckBox bnOffline = new JCheckBox();
  BorderLayout borderLayout8 = new BorderLayout();
  JLabel lbSystemSSL = new JLabel();
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæ–¤æ‹·é”Ÿå±Šå‡½é”Ÿæ–¤æ‹\uFFFD
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public JBOFMDIMainWindow() {
      super();
      //addMouseListener(this);
      try {
          jbInit();

          MainTabbedPane.addCloseListener(this);
          MainTabbedPane.addPopupMenuListener(this);
      }
      catch(Exception e) {
          e.printStackTrace();
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæ–¤æ‹·é”Ÿå±Šå‡½é”Ÿæ–¤æ‹\uFFFD(é”Ÿç»“ä¾›ä¸€é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æºè£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·)
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public JBOFMDIMainWindow(JBOFApplication App) {
      super();
      //addMouseListener(this);
      ParentObject = App;
      Application = App;
      if ( Application != null ) {
          if ( Application.getMainWindow() == null ) Application.setMainWindow(this);
      }
      try {
          jbInit();
      }
      catch(Exception e) {
          e.printStackTrace();
      }

      MainTabbedPane.addCloseListener(this);
      MainTabbedPane.addPopupMenuListener(this);

  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·è¯´é”Ÿ?
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  private void LoadGUIMenu() {
    String RB=null;
    WindowIcon = JXMLResource.LoadSImageIcon(Application.BOFApplicationStub.name+"/Resource",Application.BOFApplicationStub.img1);
    RB = Application.BOFApplicationStub.name+"/Resource";
    JGUILoader SaxParser = new JGUILoader(this,Application,SystemMenuList,MainMenu,ToolbarList,RB,null);
    String XMLGuiDefineFile;
//      XMLGuiDefineFile  = JActiveDComDM.CodeBase+Application.BOFApplicationStub.name+"/Resource/";
//      XMLGuiDefineFile += JActiveDComDM.International+"/"+Application.BOFApplicationStub.XML_STYLE_MDI;
      URL url = JXMLResource.LoadSXML(Application.BOFApplicationStub.name+"/Resource/",Application.BOFApplicationStub.XML_STYLE_MDI);
      try {
        XMLGuiDefineFile = url.toString();
        SaxParser.LoadGUIMenu(XMLGuiDefineFile, null, "toolbars", "mainmenu");
      } catch ( Exception e ) {
        e.printStackTrace();
      }
      if ( ToolbarList.size() > 0 )
        MainToolBar = (JBOFToolBar)ToolbarList.get(0);
      FindSystemMainMenu();
//      JCheckBoxMenuItem mi = new JCheckBoxMenuItem();
//      mi.setText(MainToolBar.getName());
//      mi.setActionCommand(MainToolBar.getToolBarID());
//      mi.setSelected(true);
//      mnToolbar.add(mi);
      LoadPopopMenu();
  }
  private void LoadPopopMenu() {
    String URI=null,RB=null;
    RB = this.getClass().getName().replace('.','/');;
    RB = "Codebase/"+RB;
//    URI = JActiveDComDM.CodeBase+RB+"/"+JActiveDComDM.International+"/TabPopupMenu.xml";
    URL url = JXMLResource.LoadXML(this,"TabPopupMenu.xml");
    URI = url.toString();
    JGUILoader SaxParser = new JGUILoader(this,Application,PopupMenuList,TablePopupMenu,ToolbarList,RB,this);
    SaxParser.LoadGUIMenu(URI,null,"toolbars","mainmenu");
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·è¯´é”Ÿ?
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void FindSystemMainMenu() {
    JMenuItemStub MenuStub;
    for(int i=0;i<SystemMenuList.size();i++) {
      MenuStub = (JMenuItemStub)SystemMenuList.get(i);
      if ( MenuStub.Name.equals("mnFile") == true )
        mnFile   = MenuStub.Menu;
      if ( MenuStub.Name.equals("mnEdit") == true )
        mnEdit   = MenuStub.Menu;
      if ( MenuStub.Name.equals("mnTools")== true )
        mnTools   = MenuStub.Menu;
      if ( MenuStub.Name.equals("mnWindow")== true )
        mnWindow   = MenuStub.Menu;
      if ( MenuStub.Name.equals("mnHelp") == true )
        mnHelp   = MenuStub.Menu;
      if ( MenuStub.Name.equals("mnView") == true )
        mnView   = MenuStub.Menu;
      if ( MenuStub.Name.equals("mnToolbar") == true )
        mnToolbar   = MenuStub.Menu;
      if ( MenuStub.Name.equals("mnStatusbar") == true ) {
        mnStatus   = MenuStub.MenuItem;
        if ( mnStatus != null ) mnStatus.setSelected(true);
      }
      if ( MenuStub.Name.equals("SystemToolbar") == true ) {
        mnMainToolbar   = MenuStub.MenuItem;
        if ( mnMainToolbar != null ) mnMainToolbar.setSelected(true);
      }
    }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æº
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public JMenuItemStub FindMenuItem(String Name) {
    JMenuItemStub MenuStub=null;
    for(int i=0;i<SystemMenuList.size();i++) {
      MenuStub = (JMenuItemStub)SystemMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true )
        return MenuStub;
    }
    JBOFMDIChildWindow FWP;
    FWP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
    if ( FWP == null ) return null;
    for(int i=0;i<FWP.XMLStubMenuList.size();i++) {
      MenuStub = (JMenuItemStub)FWP.XMLStubMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true )
        return MenuStub;
    }
    return null;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æº
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void setMenuEnabled(String Name,boolean Enable) {
    JMenuItemStub MenuStub=null;
    for(int i=0;i<SystemMenuList.size();i++) {
      MenuStub = (JMenuItemStub)SystemMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) MenuStub.MenuItem.setEnabled(Enable);
        if ( MenuStub.Button != null ) MenuStub.Button.setEnabled(Enable);
      }
    }
    JBOFMDIChildWindow FWP;
    FWP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
    if ( FWP == null ) return;
    for(int i=0;i<FWP.XMLStubMenuList.size();i++) {
      MenuStub = (JMenuItemStub)FWP.XMLStubMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) MenuStub.MenuItem.setEnabled(Enable);
        if ( MenuStub.Button != null ) MenuStub.Button.setEnabled(Enable);
      }
    }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æº
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public boolean getMenuEnabled(String Name) {
    JMenuItemStub MenuStub=null;
    for(int i=0;i<SystemMenuList.size();i++) {
      MenuStub = (JMenuItemStub)SystemMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) return MenuStub.MenuItem.isEnabled();
        if ( MenuStub.Button != null ) return MenuStub.Button.isEnabled();
      }
    }
    JBOFMDIChildWindow FWP;
    FWP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
    if ( FWP == null ) return false;
    for(int i=0;i<FWP.XMLStubMenuList.size();i++) {
      MenuStub = (JMenuItemStub)FWP.XMLStubMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) return MenuStub.MenuItem.isEnabled();
        if ( MenuStub.Button != null ) return MenuStub.Button.isEnabled();
      }
    }
    return false;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æº
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void setMenuVisible(String Name,boolean Enable) {
    JMenuItemStub MenuStub=null;
    for(int i=0;i<SystemMenuList.size();i++) {
      MenuStub = (JMenuItemStub)SystemMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) MenuStub.MenuItem.setVisible(Enable);
        if ( MenuStub.Button != null ) MenuStub.Button.setVisible(Enable);
      }
    }
    JBOFMDIChildWindow FWP;
    FWP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
    if ( FWP == null ) return;
    for(int i=0;i<FWP.XMLStubMenuList.size();i++) {
      MenuStub = (JMenuItemStub)FWP.XMLStubMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) MenuStub.MenuItem.setVisible(Enable);
        if ( MenuStub.Button != null ) MenuStub.Button.setVisible(Enable);
      }
    }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æº
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public boolean getMenuVisible(String Name) {
    JMenuItemStub MenuStub=null;
    for(int i=0;i<SystemMenuList.size();i++) {
      MenuStub = (JMenuItemStub)SystemMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) return MenuStub.MenuItem.isVisible();
        if ( MenuStub.Button != null ) MenuStub.Button.isVisible();
      }
    }
    JBOFMDIChildWindow FWP;
    FWP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
    if ( FWP == null ) return false;
    for(int i=0;i<FWP.XMLStubMenuList.size();i++) {
      MenuStub = (JMenuItemStub)FWP.XMLStubMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) return MenuStub.MenuItem.isVisible();
        if ( MenuStub.Button != null ) MenuStub.Button.isVisible();
      }
    }
    return false;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æº
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void setMenuSelected(String Name,boolean Selected) {
    JMenuItemStub MenuStub=null;
    for(int i=0;i<SystemMenuList.size();i++) {
      MenuStub = (JMenuItemStub)SystemMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) MenuStub.MenuItem.setSelected(Selected);
        if ( MenuStub.Button != null ) MenuStub.Button.setSelected(Selected);
      }
    }
    JBOFMDIChildWindow FWP;
    FWP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
    if ( FWP == null ) return;
    for(int i=0;i<FWP.XMLStubMenuList.size();i++) {
      MenuStub = (JMenuItemStub)FWP.XMLStubMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) MenuStub.MenuItem.setSelected(Selected);
        if ( MenuStub.Button != null ) MenuStub.Button.setSelected(Selected);
      }
    }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æº
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public boolean getMenuSelected(String Name) {
    JMenuItemStub MenuStub=null;
    for(int i=0;i<SystemMenuList.size();i++) {
      MenuStub = (JMenuItemStub)SystemMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) return MenuStub.MenuItem.isSelected();
        if ( MenuStub.Button != null ) return MenuStub.Button.isSelected();
      }
    }
    JBOFMDIChildWindow FWP;
    FWP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
    if ( FWP == null ) return false;
    for(int i=0;i<FWP.XMLStubMenuList.size();i++) {
      MenuStub = (JMenuItemStub)FWP.XMLStubMenuList.get(i);
      if ( MenuStub.Name.equals(Name) == true ) {
        if ( MenuStub.MenuItem != null ) return MenuStub.MenuItem.isSelected();
        if ( MenuStub.Button != null ) return MenuStub.Button.isSelected();
      }
    }
    return false;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: è£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æº
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
//  protected void LoadResource(JDomXmlGUIResource guir) {
//      GUIResource = guir;
//      if ( GUIResource != null ) {
//          GUIResource.SetBOF(Application.DComDM.systembof,this);
//          GUIResource.LoadGUIResource();
//      }
// }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: åº”é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æº
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  protected void ApplyResource() {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æºè£…é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹\uFFFD
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
//  public void SetResourceLoader(JDomXmlGUIResource guir) {
//      GUIResource = guir;
//  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·åº”é”Ÿæ–¤æ‹·çŠ¶æ\uFFFDé”Ÿæ–¤æ‹·
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void SetApplicationStatus(String StatusString) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·åº”é”ŸçŸ«æ†‹æ‹·é”Ÿæ–¤æ‹·
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void SetApplicationTitle(String title, Icon icon) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæ–¤æ‹·ä¸€é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·èŸ ç¿±é”\uFFFD?
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public Component OpenObjectWindow(String title,Icon icon, String tip,Component comp) {
    initCallBackWindowClazz();
    if (this.callBackWindowClazz != null) {
      // é”Ÿæ–¤æ‹·é”ŸçŸ«å›ç¢‰æ‹·é”\uFFFD?
      ( (JBOFChildWindow) comp).MainWindow = this;
       ( (JBOFChildWindow) comp).setTitle(title);
      callBackOpenObjectWindow(title, icon, tip, comp);
      return comp;
    }

      if ( comp != null ) {
        ((JBOFChildWindow)comp).MainWindow = this;
          if ( MainTabbedPane.indexOfComponent(comp) == -1 ) {

            //CompoundIcon compicon = new CompoundIcon(CloseImageIcon,icon,CompoundIcon.HORIZONTAL,0);

            //é”Ÿé“°åŒ¡æ‹·é”Ÿæ–¤æ‹·é¡µé”ŸèŠ¥éƒ½é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·å‰é”ŸèŠ¥ã\uFFFD\uFFFD
            //MainTabbedPane.insertTab(title,icon,comp,tip,0);
            MainTabbedPane.addTab(title,icon,comp,tip);
            //MainTabbedPane.addTab(title,compicon,comp,tip);

            ((JBOFChildWindow)comp).WindowOpened();
            JMenuItem mi = new JMenuItem();
            mi.setText(title);mi.setIcon(icon);
            ((JBOFMDIChildWindow)comp).WindowMenuItem = mi;
            mi.setActionCommand("ActiveLive");
            mi.addActionListener((JBOFMDIChildWindow)comp);
            mnWindow.add(mi);
            CreateCloseButton(comp);

          }
          MainTabbedPane.setSelectedComponent(comp);
          MainTabbedPane.repaint();
      }

      return comp;
  }
  void CreateCloseButton(Component comp) {
//    Rectangle  rect;int Index;Icon CompIcon;
//    Index = MainTabbedPane.indexOfComponent(comp);
//    CompIcon = MainTabbedPane.getIconAt(Index);
//    BufferedImage  Image = new BufferedImage(CloseImageIcon.getIconWidth()+CompIcon.getIconWidth(),CompIcon.getIconHeight(),BufferedImage.TYPE_3BYTE_BGR);
//    Graphics gs = Image.getGraphics();
//    CompIcon.
//    gs.drawImage(CloseImageIcon.getImage(),0,0,CloseImageIcon.getIconWidth(),CloseImageIcon.getIconHeight(),CloseImageIcon.getImageObserver());
//    CompIcon.paintIcon(MainTabbedPane,gs,CloseImageIcon.getIconWidth(),0);
//    Image
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void setTitleAt(Component comp,String Title) {
    int Index;
    if ( comp != null ) {
        Index = MainTabbedPane.indexOfComponent(comp);
        if ( Index != -1 ) {
          MainTabbedPane.setTitleAt(Index,Title);
          if ( ((JBOFMDIChildWindow)comp).WindowMenuItem != null )
            ((JBOFMDIChildWindow)comp).WindowMenuItem.setText(Title);
        }
        MainTabbedPane.repaint();
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void setToolTipTextAt(Component comp,String Title) {
    int Index;
    if ( comp != null ) {
        Index = MainTabbedPane.indexOfComponent(comp);
        if ( Index != -1 )
          MainTabbedPane.setToolTipTextAt(Index,Title);
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void setIconAt(Component comp,Icon icon) {
    int Index;
    if ( comp != null ) {
        Index = MainTabbedPane.indexOfComponent(comp);
        if ( Index != -1 )
          MainTabbedPane.setIconAt(Index,icon);
        MainTabbedPane.repaint();
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæˆªæ†‹æ‹·é”Ÿæ–¤æ‹·é”Ÿå«è®¹æ‹·é”Ÿè¥Ÿçª—åŒ¡æ‹·
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public boolean CloseAllWindow() {
    JBOFMDIChildWindow FP;int i = 0,Count;boolean Res = true;
    Vector FPList = new Vector();
      Count = MainTabbedPane.getTabCount();// .getComponentCount();
      for(i=1;i<Count;i++) {
        FP = (JBOFMDIChildWindow)MainTabbedPane.getComponentAt(i);// .getComponent(i);
        FPList.add(FP);
      }
      Count = FPList.size();
      for(i=0;i<Count;i++) {
        FP = (JBOFMDIChildWindow)FPList.get(i);
//            if ( FP.Close() ) {
                Res = CloseObjectWindow(FP);
//            } else Res = false;
      }
      return Res;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæˆªæ†‹æ‹·é”Ÿæ–¤æ‹·é”Ÿå«è®¹æ‹·é”Ÿè¥Ÿçª—åŒ¡æ‹·
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public JBOFChildWindow GetCurrentWindow() {
    JBOFChildWindow FP;
      FP = (JBOFChildWindow)MainTabbedPane.getSelectedComponent();
      return FP;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæ–¤æ‹·å§‹é”Ÿæ–¤æ‹·é”Ÿæˆªç¡·æ‹\uFFFD
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  private void jbInit() throws Exception {
    this.MainTabbedPane.setTabLayoutPolicy(JTabbedPane.SCROLL_TAB_LAYOUT);
      LoadGUIMenu();
      contentPane = (JPanel) this.getContentPane();
      titledBorder1 = new TitledBorder("");
      contentPane.setLayout(MainborderLayout);
      this.setJMenuBar(MainMenu);
      this.addWindowListener(this);

      /**
       * é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”ŸçŸ«æ†‹æ‹·é”Ÿè§£ã€\uFFFD
       * é”Ÿæ–¤æ‹·é”Ÿé¥ºç¡·æ‹·é”Ÿæ–¤æ‹·é”Ÿçš†è¾¾æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æ¬ é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·æ²¡é”Ÿå«ï½æ‹·é”Ÿæ–¤æ‹·å–XMLé”Ÿå«è®¹æ‹·é”Ÿæ–¤æ‹·æ‘¹é”\uFFFD?
       */
      String pTitle = null;
      try {
        if (mPublicStrings == null) {
          mPublicStrings = ResourceBundle.getBundle(
              "fmis.publicresource.Language");
        }
        pTitle = mPublicStrings.getString("SOFT_DESCRIPTION");
      }
      catch (Exception E) {

      }
      if (pTitle == null || pTitle.equals("")) {
        if (Application != null) {
          pTitle = Application.BOFApplicationStub.description;
        }
      }
      setTitle(pTitle);

      contentPane.setMinimumSize(new Dimension(87, 67));
      contentPane.setPreferredSize(new Dimension(400, 66));
      contentPane.setToolTipText("");
      //MainMenu.setFont(new java.awt.Font("dialog", 0, 12));
//      MenuSp.setFont(MenuFont);
      //MenuSp.setText("|");
      MenuSp.setEnabled(false);
      //MainMenu.setFont(new java.awt.Font("é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·", 1, 12));

      MainTabbedPane.addChangeListener(this);

      //MainTabbedPane.addMouseListener(this);

      pnToolbar.setLayout(verticalFlowLayout1);
      pnBottom.setLayout(borderLayout1);
    verticalFlowLayout1.setHgap(0);
    verticalFlowLayout1.setVgap(0);
    verticalFlowLayout1.setVerticalFill(true);
    pnToolbar1.setLayout(flowLayout1);
    flowLayout1.setAlignment(FlowLayout.LEFT);
    flowLayout1.setHgap(0);
    flowLayout1.setVgap(0);
    pnToolbar2.setLayout(flowLayout2);
    flowLayout2.setAlignment(FlowLayout.LEFT);
    flowLayout2.setHgap(0);
    flowLayout2.setVgap(0);
    //MainToolBar.setFont(MenuFont);
    pnToolbar3.setLayout(flowLayout5);
    flowLayout5.setAlignment(FlowLayout.LEFT);
    flowLayout5.setHgap(0);
    flowLayout5.setVgap(0);
    pnStatus.setLayout(borderLayout4);
    pbProgressBar.setBorder(titledBorder1);
    pbProgressBar.setPreferredSize(new Dimension(100, 28));
    pnBottom2.setLayout(borderLayout8);
    pnBottom12.setLayout(borderLayout5);
    pnBottom11.setLayout(borderLayout2);
    pnBottom1.setLayout(borderLayout3);
    statusLabel1.setBorder(titledBorder1);
    pnBottom2.setPreferredSize(new Dimension(100, 26));
    pnBottom1.setPreferredSize(new Dimension(83, 24));
    statusLabel2.setBorder(titledBorder1);
    statusLabel2.setToolTipText("");
    statusLabel2.setText(" ");
    jPanel1.setLayout(borderLayout6);
    statusLabel3.setBorder(titledBorder1);
    statusLabel3.setToolTipText("");
    statusLabel3.setText(" ");
    statusLabel4.setToolTipText("");
    statusLabel4.setText(" ");
    statusLabel4.setBorder(titledBorder1);
    jPanel2.setLayout(borderLayout7);
    bnOffline.setBorder(titledBorder1);
    bnOffline.setBorderPainted(true);
    bnOffline.setText("");
    bnOffline.setBorderPaintedFlat(true);
    pnStatus.setPreferredSize(new Dimension(183, 24));
    lbSystemSSL.setBorder(titledBorder1);
    pnBottom.add(pnToolbar3,  BorderLayout.NORTH);
    pnBottom.add(pnStatus, BorderLayout.SOUTH);
    pnStatus.add(pnBottom2,  BorderLayout.EAST);
    pnBottom2.add(pbProgressBar,  BorderLayout.CENTER);
    pnBottom2.add(lbSystemSSL,  BorderLayout.WEST);
    pnStatus.add(pnBottom1,  BorderLayout.CENTER);
    pnBottom1.add(pnBottom11,  BorderLayout.CENTER);
    pnBottom11.add(statusLabel1,  BorderLayout.CENTER);
    pnBottom1.add(pnBottom12,  BorderLayout.EAST);
//    pnBottom12.add(bnOffline,  BorderLayout.SOUTH);
    pnBottom12.add(jPanel1,  BorderLayout.CENTER);
    jPanel1.add(statusLabel2,  BorderLayout.CENTER);
    jPanel1.add(statusLabel3,  BorderLayout.EAST);
    pnBottom12.add(jPanel2,  BorderLayout.EAST);
    jPanel2.add(statusLabel4,  BorderLayout.CENTER);
    jPanel2.add(bnOffline,  BorderLayout.EAST);
    contentPane.add(MainTabbedPane,  BorderLayout.CENTER);
      contentPane.add(pnToolbar, BorderLayout.NORTH);
    pnToolbar.add(pnToolbar1, null);
    pnToolbar.add(pnToolbar2, null);
      //this.setFont(MenuFont);
      //pnToolbar.setFont(MenuFont);
      //MainMenu.add(MenuWindow);
      //MainMenu.add(MenuHelp);
//      TablePopupMenu.add(mniClose);
//      TablePopupMenu.add(mniXClose);
//      TablePopupMenu.add(mniCloseAll);
//      TablePopupMenu.addSeparator();
    contentPane.add(pnBottom, BorderLayout.SOUTH);
    pnToolbar1.add(MainToolBar, null);
      AddSystemMenu();
      MainTabbedPane.setBorder(BorderFactory.createLoweredBevelBorder());
      //MainTabbedPane.setBackground(Color.gray);
      ImageIcon II;
      II = JXMLResource.LoadImageIcon(this,"online.gif");
      bnOffline.setIcon(II);
      II = JXMLResource.LoadImageIcon(this,"offline.gif");
      bnOffline.setSelectedIcon(II);
      bnOffline.setSelected(JActiveDComDM.SystemOffline);
      bnOffline.addActionListener(this);
      if ( JActiveDComDM.SystemSSL )
        II = JXMLResource.LoadImageIcon(this,"lock.gif");
      else
        II = JXMLResource.LoadImageIcon(this,"unlock.gif");
      lbSystemSSL.setIcon(II);
      JActiveDComDM.addEventObject(this);
      CloseImageIcon = JXMLResource.LoadImageIcon(this,"close.gif");
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  private void AddSystemMenu() {
    /*
    int i,Count;JBOFApplication bis;JMenuItem mItem;
      Count = JActiveDComDM.BOFApplicationManager.ApplicationList.size();
      for(i=0;i<Count;i++) {
          bis = (JBOFApplication)JActiveDComDM.BOFApplicationManager.ApplicationList.elementAt(i);
          if ( !bis.BOFApplicationStub.name.equals(Application.BOFApplicationStub.name) ) {
              mItem = new JMenuItem();
              mItem.setFont(MenuFont);
              mItem.setText(bis.BOFApplicationStub.description);
              mItem.setActionCommand(bis.BOFApplicationStub.name);
              mItem.addActionListener(this);
              jOtherSystem.add(mItem);
              SystemMenuList.add(mItem);
          }
      }*/
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void ProcessOffline(ActionEvent e) {
    try {
      JActiveDComDM.setSystemOffline(bnOffline.isSelected());
    } catch ( Exception ee ) {
      bnOffline.setSelected(!bnOffline.isSelected());
    }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public Object ObjectStatusChange(Object ChangeObject) {
    bnOffline.setSelected(JActiveDComDM.SystemOffline);
    return null;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void actionPerformed(ActionEvent e) {
    Object Sender = e.getSource();
    if ( Sender == this.mnStatus ) {
      pnStatus.setVisible(mnStatus.isSelected());
      return;
    }
    if ( Sender == this.mnMainToolbar && MainToolBar != null ) {
      MainToolBar.setVisible(mnMainToolbar.isSelected());
      return;
    }
    // é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·Bar
    setToolbarVisible(e.getActionCommand());
    // é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·/é”Ÿæ–¤æ‹·é”Ÿç«­è¯§æ‹·é”Ÿæ–¤æ‹·
    if ( Sender == bnOffline ) {
      ProcessOffline(e);
      return;
    }
    // é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·PopMenu
    ProcessPopMenu(Sender,e);
    // é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·SysMenu
    PorcessSysMenu(Sender,e);
    return;
  }
  void setToolbarVisible(String Name) {
    JBOFMDIChildWindow cw = (JBOFMDIChildWindow)this.GetCurrentWindow();
    if ( cw.ToolbarList == null ) return;
    JBOFToolBar bar;String ID;
    for(int i=0;i<cw.ToolbarList.size();i++) {
      bar = (JBOFToolBar)cw.ToolbarList.get(i);
      if ( bar == null ) continue;
      ID = bar.getToolBarID();
      if ( ID != null && ID.equals(Name) ) {
        if ( bar.CustomObject != null ) {
          bar.setVisible(((JMenuItem)bar.CustomObject).isSelected());
        }
      }
    }

  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void PorcessSysMenu(Object Sender,ActionEvent e) {
    int i,Count;JMenuItemStub MIS;String ActionCommand;
    Count = this.SystemMenuList.size();
    for(i=0;i<Count;i++) {
      MIS = (JMenuItemStub)SystemMenuList.get(i);
        if ( Sender == MIS.MenuItem || Sender == MIS.Button ) {
            Application.CallOperateItem(MIS.OperateItem,MIS,e);
            break;
        }
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void ProcessPopMenu(Object Sender,ActionEvent e) {
    int i,Count;JMenuItemStub MIS;String ActionCommand;
    Count = this.PopupMenuList.size();
    for(i=0;i<Count;i++) {
      MIS = (JMenuItemStub)PopupMenuList.get(i);
        if ( Sender == MIS.MenuItem || Sender == MIS.Button ) {
            ActionCommand = MIS.MenuItem.getName();
            if ( ActionCommand.equals("mnCloseCurrent") ) {
              this.mniClose_actionPerformed(e);
              return;
            }
            if ( ActionCommand.equals("mnCloseOther") ) {
              this.mniXClose_actionPerformed(e);
              return;
            }
            if ( ActionCommand.equals("mnCloseAll") ) {
              this.mniCloseAll_actionPerformed(e);
              return;
            }
            break;
        }
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void SystemMenuItem_actionPerformed(ActionEvent e) {
    String lnfName = e.getActionCommand();
      JActiveDComDM.BOFApplicationManager.Execute(lnfName,null,0);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void miCloseCurrentWindow_actionPerformed(ActionEvent e) {
      CloseObjectWindow(GetCurrentWindow());
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void CloseCurrentWindow() {
    CloseObjectWindow(GetCurrentWindow());
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void miCloseAllWindow_actionPerformed(ActionEvent e) {
      CloseAllWindow();
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void RadioButtonMenuItem_actionPerformed(ActionEvent e) {
    /*
    String lnfName = e.getActionCommand();
      try {
          UIManager.setLookAndFeel(lnfName);
          SwingUtilities.updateComponentTreeUI(this);
          jRadioButtonMenuItem1.setSelected(false);
          jRadioButtonMenuItem2.setSelected(false);
          jRadioButtonMenuItem3.setSelected(false);
          jRadioButtonMenuItem4.setSelected(false);
          JRadioButtonMenuItem button = (JRadioButtonMenuItem)e.getSource();
          button.setSelected(true);
          //this.pack();
      } catch (Exception exc) {
          JRadioButtonMenuItem button = (JRadioButtonMenuItem)e.getSource();
          button.setEnabled(false);
          System.err.println("Could not load LookAndFeel: " + lnfName);
      }*/
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void miAbout_actionPerformed(ActionEvent e) {
      if ( Application != null )
          Application.About();
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void miComWebSite_actionPerformed(ActionEvent e) {
//      if ( Application != null )
//          Application.ComWebSite(null,null,null);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void miTechWebSite_actionPerformed(ActionEvent e) {
//      if ( Application != null )
//          Application.TechWebSite(null,null,null);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void windowActivated(WindowEvent e) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void windowClosed(WindowEvent e) {
    WaitThread.interrupt();
    WaitThread = null;
    JActiveDComDM.delEventObject(this);
    JActiveDComDM.DataActiveFramework.InvokeObjectMethod("LoginfoObject","Logout");
    /**
     * é”Ÿæ–¤æ‹·å½•é”Ÿå‰¿ç­¹æ‹·é”Ÿæ–¤æ‹·å¿—
     * add by hufeng 2006.7.3
     */
    JLogManager.writeLoginOut();
    //
    System.exit(0);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void windowClosing(WindowEvent e) {
      this_windowClosing(e);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void windowDeactivated(WindowEvent e) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void windowDeiconified(WindowEvent e) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void windowIconified(WindowEvent e) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void windowOpened(WindowEvent e) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void this_windowClosing(WindowEvent e) {
      if ( CloseAllWindow() ) {
        this.setDefaultCloseOperation(EXIT_ON_CLOSE);
        windowClosed(e);
//        if ( JActiveDComDM.MainFramework != null &&
//             JActiveDComDM.MainFramework instanceof java.awt.Frame ) {
//          System.exit(0);
//        }
      } else {
        this.setDefaultCloseOperation(DO_NOTHING_ON_CLOSE);
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:é”Ÿæ–¤æ‹·æºé”Ÿæ–¤æ‹·ä½é”Ÿæ–¤æ‹·æ¯é”Ÿç»?ApplicationClassName.FrameworkWindow.é”Ÿæ–¤æ‹·æºé”Ÿæ–¤æ‹\uFFFD
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public String GetResourceByID(String ID) {
//    String Res = null;
//      if ( GUIResource != null )
//          Res = GUIResource.GetResourceByID(ID);
//      return Res;
    return null;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void miHelptopics_actionPerformed(ActionEvent e) {
//      if ( Application != null )
//          Application.Help(null,null,null);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void miMinWindow_actionPerformed(ActionEvent e) {

  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void stateChanged(ChangeEvent e) {
    if ( e.getSource() == this.MainTabbedPane )
      MainTabbedPane_stateChanged(e);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void MainTabbedPane_stateChanged(ChangeEvent e) {
    JBOFMDIChildWindow FWP;
      DelAllChildWindowGUIResource();
      FWP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
      if ( CurrentChildWindow != null ) {
        CurrentChildWindow.WindowDeActive(this);
      }
      if ( FWP != null && FWP.Application != null ) {
          AddChildWindowMainMenu(FWP);
          // é”Ÿæ–¤æ‹·é”Ÿé“°ç¡·æ‹·è¦é”Ÿæ–¤æ‹·é”Ÿæ·ç¢‰æ‹·é”Ÿè§£éƒ¨é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·
          JActiveDComDM.BusinessActiveFramework.InvokeObjectMethod(
              FWP.Application.BOFApplicationStub.name,// é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·ä¸ºåº”é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹\uFFFD
              "ChildWindowSwitch",// é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹\uFFFD
              this,// é”Ÿæ–¤æ‹·ä¸€é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿè½¿îæ‹·é”Ÿæ–¤æ‹\uFFFD
              FWP,// é”ŸèŠ‚è®¹æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·å“Ÿé”Ÿæ–¤æ‹·é”Ÿ?
              null,FWP.Application);// é”Ÿæ–¤æ‹·é”Ÿä¾¥é©æ‹·ä¸ºåº”é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿ?
          FWP.WindowActive(this);
          CurrentChildWindow = FWP;
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void DelChildWindowMainMenu(JBOFMDIChildWindow fwp) {
    int i,Count;com.jidesoft.swing.JideMenu Menu;//MenuElement ME;
      if ( fwp != null && fwp.MainMenu != null && fwp.MenuList != null ) {
          try {
              Count = fwp.MenuList.size();
              for(i=0;i<Count;i++) {
                  Menu = (com.jidesoft.swing.JideMenu)fwp.MenuList.get(i);
                  if ( Menu != null ) MainMenu.remove(Menu);
              }
              //MainMenu.remove(MenuSp);
          }catch(Exception e) {
              e.printStackTrace();
          }
      }
      DelChildWindowPopupMenu(fwp);
      DelChildWindowToolbar(fwp);
  }
/*
  Menu = (JMenuItem)fwp.PopupMenuList.get(i);
                  TablePopupMenu.add(Menu,i+3);
*/
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void DelChildWindowPopupMenu(JBOFMDIChildWindow fwp) {
    int i,Count;Component Menu;//MenuElement ME;
      if ( fwp != null && fwp.PopupMenuList != null ) {
          try {
              Count = fwp.PopupMenuList.size();
              for(i=0;i<Count;i++) {
                  Menu = (Component)fwp.PopupMenuList.get(i);
                  TablePopupMenu.remove(Menu);
              }
              TablePopupMenu.remove(MenuSp);
          }catch(Exception e) {
              e.printStackTrace();
          }
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void DelChildWindowToolbar(JBOFMDIChildWindow fwp) {
    int i,Count;JBOFToolBar Toolbar;
      if ( fwp != null && fwp.ToolbarList != null ) {
          try {
              Count = fwp.ToolbarList.size();
              for(i=0;i<Count;i++) {
                  Toolbar = (JBOFToolBar)fwp.ToolbarList.get(i);
                  if ( Toolbar.CustomObject != null ) {
                    mnToolbar.remove((JMenuItem)Toolbar.CustomObject);
                  }
                  if ( Toolbar.ToolbarLayout == 1 ) {
                    pnToolbar1.remove(Toolbar);
                    pnToolbar1.repaint();
                  }
                  if ( Toolbar.ToolbarLayout == 2 ) {
                    pnToolbar2.remove(Toolbar);
                    pnToolbar2.repaint();
                  }
                  if ( Toolbar.ToolbarLayout == 3 ) {
                    pnToolbar3.remove(Toolbar);
                    pnToolbar3.repaint();
                  }
              }
          }catch(Exception e) {
              e.printStackTrace();
          }
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void DelAllChildWindowGUIResource() {
    int i,Count;JBOFMDIChildWindow fwp;Component comp;
      Count = this.MainTabbedPane.getComponentCount();
      for(i=0;i<Count;i++) {
          comp = this.MainTabbedPane.getComponent(i);
          if ( comp instanceof JBOFMDIChildWindow ) {
              fwp = (JBOFMDIChildWindow)comp;
              DelChildWindowMainMenu(fwp);
          }
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void AddChildWindowMainMenu(JBOFMDIChildWindow fwp) {
    int i,Count;com.jidesoft.swing.JideMenu Menu;//MenuElement ME;
    int Index = 0;
      if ( fwp != null && fwp.MainMenu != null && fwp.MenuList != null ) {
          try {
              Count = fwp.MenuList.size();
              for(i=0;i<Count;i++) {
                  Menu = (com.jidesoft.swing.JideMenu)fwp.MenuList.get(i);
                  if ( Menu != null ) {
                    MainMenu.add( (com.jidesoft.swing.JideMenu) Menu, Index + 3);Index++;
                  }
              }
              //MainMenu.add(MenuSp,Count);
          }catch(Exception e) {
              e.printStackTrace();
          }
      }
      AddChildWindowPopupMenu(fwp);
      AddChildWindowToolbar(fwp);
      MainMenu.repaint();
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void AddChildWindowPopupMenu(JBOFMDIChildWindow fwp) {
    int i,Count;Component Menu;
      if ( fwp != null && fwp.PopupMenuList != null ) {
          try {
              Count = fwp.PopupMenuList.size();
              if ( Count > 0 ) TablePopupMenu.add(MenuSp);
              int CN = TablePopupMenu.getComponentCount();
              for(i=0;i<Count;i++) {
                  Menu = (Component)fwp.PopupMenuList.get(i);
                  if ( Menu != null )
                    TablePopupMenu.add(Menu,i+4);
              }
          }catch(Exception e) {
              e.printStackTrace();
          }
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void AddChildWindowToolbar(JBOFMDIChildWindow fwp) {
    int i,Count;JBOFToolBar Toolbar;int Index,Cnt;Component comp;JButton BN;
    Insets insets;
      if ( fwp != null ) {
          try {
              insets=new Insets(2,2,2,2);
              Count = fwp.ToolbarList.size();
              for(i=0;i<Count;i++) {
                  Toolbar = (JBOFToolBar)fwp.ToolbarList.get(i);
                  // é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿå‰¿ç¢‰æ‹·é”Ÿæ–¤æ‹\uFFFD
                  if ( Toolbar != null ) {
                    JCheckBoxMenuItem TBMenuItem;
                    if ( Toolbar.CustomObject != null ) {
                      TBMenuItem = (JCheckBoxMenuItem)Toolbar.CustomObject;
                      mnToolbar.remove(TBMenuItem);
                    } else
                      TBMenuItem = new JCheckBoxMenuItem();
                    TBMenuItem.addActionListener(this);
                    Toolbar.CustomObject = TBMenuItem;
                    TBMenuItem.setText(Toolbar.getName());
                    TBMenuItem.setActionCommand(Toolbar.getToolBarID());
                    TBMenuItem.setSelected(Toolbar.isVisible());

                    mnToolbar.add(TBMenuItem);
                  }
                    if ( Toolbar.ToolbarLayout == 1 )
                      pnToolbar1.add(Toolbar,-1);
                    if ( Toolbar.ToolbarLayout == 2 )
                      pnToolbar2.add(Toolbar,-1);
                    if ( Toolbar.ToolbarLayout == 3 ) {
                      pnToolbar3.add(Toolbar,-1);
                    }
                    //Toolbar.setVisible(Toolbar.isShow);
                    Toolbar.repaint();
                  Cnt = Toolbar.getComponentCount();
                  for(Index=0;Index<Cnt;Index++) {
                      comp = Toolbar.getComponent(Index);
                      if ( comp instanceof JButton ) {
                          BN = (JButton)comp;
                          BN.setMargin(insets);
                      }
                  }
              }
          }catch(Exception e) {
              e.printStackTrace();
          }
      }
      //pnToolbar.repaint();
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void MouseClickCloseWindow(Point p) {
    int Width = 0;
    int Index = this.MainTabbedPane.indexAtLocation(p.x,p.y);
    if ( Index == -1 ) return;
    Component comp = this.MainTabbedPane.getComponentAt(Index);
    if ( comp == null || !(comp instanceof JBOFChildWindow) ) return;
    Icon icon = MainTabbedPane.getIconAt(Index);
    if ( icon != null ) {Width = icon.getIconWidth();}
    String Text = MainTabbedPane.getTitleAt(Index).trim();
    Width += MainTabbedPane.getGraphics().getFontMetrics().stringWidth(Text);
    int SX,SY,IW,IH;
    IW = CloseImageIcon.getIconWidth();
    IH = CloseImageIcon.getIconHeight();
    Rectangle rect = this.MainTabbedPane.getBoundsAt(Index);
    SX =  rect.x;
    if ( Width < rect.width ) {
      SX = rect.x + (rect.width - Width)/2;
    }
    SY = rect.y + (rect.height - IH)/2;
    if ( p.x >= SX && p.x <= (SX+IW) &&
         p.y >= SY && p.y <= (SY+IH) ) {
      this.CloseObjectWindow(comp);
    }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void mouseClicked(MouseEvent e) {

      if(e.getModifiers() == e.BUTTON3_MASK){
        Rectangle r = MainTabbedPane.getBoundsAt(MainTabbedPane.getSelectedIndex());
//        System.out.print(r);
          PopTabMenu(e.getComponent(),e.getPoint());
          return;
      }
      if ( e.getModifiers() == e.BUTTON1_MASK ) {
        if ( e.getClickCount() == 2 ) {
          this.MainTabbedPane.setSelectedIndex(0);
        }
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void PopTabMenu(Component comp,Point p) {
      TablePopupMenu.show(comp,p.x,p.y);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void mouseEntered(MouseEvent e) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void mouseExited(MouseEvent e) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void mousePressed(MouseEvent e) {
    if ( e.getModifiers() == e.BUTTON1_MASK ) {
      Point p = e.getPoint();
      MouseClickCloseWindow(p);
      return;
    }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void mouseReleased(MouseEvent e) {
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void mniClose_actionPerformed(ActionEvent e) {
      miCloseCurrentWindow_actionPerformed(e);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void mniXClose_actionPerformed(ActionEvent e) {
    CloseOtherWindow();
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void CloseOtherWindow() {
    JBOFMDIChildWindow FP;JBOFMDIChildWindow CurFP;int i = 0,Count;
    Vector FPList = new Vector();
      CurFP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
      Count = MainTabbedPane.getComponentCount();

      for(i=0;i<Count;i++) {
        Component pChild = MainTabbedPane.getComponent(i);
        if ( pChild instanceof JBOFMDIChildWindow){
          FP = (JBOFMDIChildWindow) pChild;
          FPList.add(FP);
        }
      }

      for(i=0;i<FPList.size();i++) {
        FP = (JBOFMDIChildWindow)FPList.get(i);
        if ( FP != null && CurFP != FP ) {
            if ( FP.Close() ) {
                CloseObjectWindow(FP);
            }
          }
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  void mniCloseAll_actionPerformed(ActionEvent e) {
      this.CloseAllWindow();
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void setActiveWindow(JBOFChildWindow cw){
    if ( cw == null ) return;
    if ( cw == this.GetCurrentWindow() ) return;
    JBOFMDIChildWindow FWP;
      DelAllChildWindowGUIResource();
      MainTabbedPane.setSelectedComponent(cw);
//      FWP = (JBOFMDIChildWindow)MainTabbedPane.getSelectedComponent();
//      if ( FWP != null && FWP.Application != null ) {
//          AddChildWindowMainMenu(FWP);
//          // é”Ÿæ–¤æ‹·é”Ÿé“°ç¡·æ‹·è¦é”Ÿæ–¤æ‹·é”Ÿæ·ç¢‰æ‹·é”Ÿè§£éƒ¨é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·
//          JActiveDComDM.BusinessActiveFramework.InvokeObjectMethod(
//              FWP.Application.BOFApplicationStub.name,// é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·ä¸ºåº”é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹\uFFFD
//              "ChildWindowSwitch",// é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹\uFFFD
//              this,// é”Ÿæ–¤æ‹·ä¸€é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿè½¿îæ‹·é”Ÿæ–¤æ‹\uFFFD
//              FWP,// é”ŸèŠ‚è®¹æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·å“Ÿé”Ÿæ–¤æ‹·é”Ÿ?
//              null,FWP.Application);// é”Ÿæ–¤æ‹·é”Ÿä¾¥é©æ‹·ä¸ºåº”é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿ?
//          FWP.WindowActive(this);
//      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void setStatusText(int Index,String Text) {
    switch ( Index ) {
    case 1:
      this.statusLabel1.setText(Text);return;
    case 2:
      this.statusLabel2.setText(Text);return;
    case 3:
      this.statusLabel3.setText(Text);return;
    case 4:
      this.statusLabel4.setText(Text);return;
    }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·: é”Ÿæˆªæ†‹æ‹·ä¸\uFFFDé”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·èŸ ç¿±é”\uFFFD?
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public boolean CloseObjectWindow(Component comp) {
      if (this.callBackWindowClazz != null) {
          // é”Ÿæ–¤æ‹·é”ŸçŸ«å›ç¢‰æ‹·é”\uFFFD?
          callBackCloseObjectWindow(comp);
          return true;
      }
      JBOFMDIChildWindow fp;
      Component cp = null;
      if (comp != null) {
          fp = (JBOFMDIChildWindow) comp;
          if (fp.Close()) {
              /**
               * é”Ÿé¥ºè¾¾æ‹·é”Ÿæ–¤æ‹·Closedé”Ÿé“°ç¡·æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿç‹¡ç­¹æ‹·
               * é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”ŸèŠ‚å…³æ†‹æ‹·é”Ÿé“°ç¡·æ‹·é”Ÿå«ï½æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·å–é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”ŸèŠ‚æ†‹æ‹·é”Ÿæ–¤æ‹·
               * modified by hufeng 2006.7.5
               */
              fp.WindowClosed();
              mnWindow.remove(fp.WindowMenuItem);
              MainTabbedPane.remove(comp);
              this.DelChildWindowMainMenu(fp);
              fp = (JBOFMDIChildWindow) MainTabbedPane.getSelectedComponent();
              //
              if (fp != CurrentChildWindow) {
                  CurrentChildWindow.WindowDeActive(this);
                  fp.WindowActive(this);
                  CurrentChildWindow = fp;
              }
              if (fp != null) {
                  this.AddChildWindowMainMenu(fp);
              }

              return true;
          } else
              return false;
      }
      return true;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:synchronized
  //----------------------------------------------------------------------------------------------
  public  void BeginWaitCursor() {
    if ( WaitCount !=  0 ) return;
    WaitCount++;
    this.pbProgressBar.setMaximum(100);
    this.pbProgressBar.setValue(0);
    DefaultCursor = getCursorType();
    setCursor(WAIT_CURSOR);
      try {
        if ( WaitThread == null ) {
          WaitThread = new JWaitThread(pbProgressBar);
          WaitThread.setPriority(Thread.NORM_PRIORITY);
//          WaitThread.setDaemon(true);
          WaitThread.start();
        } else {
          WaitThread.BeginWait();
        }
      } catch( Exception e ) {
        e.printStackTrace();
      }
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:synchronized
  //----------------------------------------------------------------------------------------------
  public  void EndWaitCursor() {
    if ( WaitCount == 0 ) return;
    WaitCount--;
    setCursor(DefaultCursor);
    if ( WaitThread != null ) {
      try {
        WaitThread.EndWait();
        this.pbProgressBar.setValue(100);
      } catch ( Exception e) {
          e.printStackTrace();
      }
    }
      this.pbProgressBar.setMaximum(100);
      this.pbProgressBar.setValue(0);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public void run() {
    int Count = 0 ;
    try {
//      synchronized ( WaitThread ) {
      while ( true ) {
        Count += 1;
        ProcessBar(Count%100);
        //pbProgressBar.repaint();
        WaitThread.yield();
        WaitThread.sleep(100);
//      }
      }
    } catch ( Exception e ) {
      //WaitThread = null;
      e.printStackTrace();
    }
    return;
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  synchronized void ProcessBar(int Value) {
    this.pbProgressBar.setValue(Value);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public int GetChildWindowCount() {
    return this.MainTabbedPane.getTabCount();
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public JBOFChildWindow GetChildWindow(int Index) {
    return (JBOFChildWindow)this.MainTabbedPane.getComponentAt(Index);
  }
  //----------------------------------------------------------------------------------------------
  //é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·:
  //é”Ÿæ–¤æ‹·é”Ÿ? Skyline(2001.12.29)
  //å®é”Ÿæ–¤æ‹·: Skyline
  //é”Ÿç«é©æ‹·:
  //----------------------------------------------------------------------------------------------
  public String getTitleAt(JBOFChildWindow wnd) {
    int Index = this.MainTabbedPane.indexOfComponent(wnd);
    return this.MainTabbedPane.getTitleAt(Index);
  }
  public Icon getIcon(JBOFChildWindow wnd) {
    int Index = this.MainTabbedPane.indexOfComponent(wnd);
    Icon icon =
    icon =  this.MainTabbedPane.getIconAt(Index);
    if ( icon instanceof CompoundIcon ) {
      return ((CompoundIcon)icon).getMainIcon();
    }
    return icon;
  }
  public void setOffline(boolean value) {
    this.bnOffline.setSelected(value);
  }

  /**
   * é”Ÿæˆªé—­è¾¾æ‹·é”ŸèŠ‚â˜…æ‹\uFFFD
   */
  public void closeOperation(MouseEvent e) {
      Point p = e.getPoint();

      int Index = this.MainTabbedPane.indexAtLocation(p.x, p.y);
      if (Index == -1)return;
      Component comp = this.MainTabbedPane.getComponentAt(Index);
      if (comp == null || ! (comp instanceof JBOFChildWindow))return;

      //é”Ÿæˆªé—­â˜…æ‹\uFFFD
      this.CloseObjectWindow(comp);
  }

  /**
   * é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·è¯´é”Ÿ?
   */
  public void popupOutsideOperation(MouseEvent e){
      PopTabMenu(e.getComponent(),e.getPoint());
  }
  /**
   *
   */
  protected Class callBackWindowClazz = null;
  /**
   *
   */
  protected void initCallBackWindowClazz() {
    String callBackClass = System.getProperty("callBackWindowClazz",null);
    if ( callBackWindowClazz != null || callBackClass == null ) return;
    try {
      callBackWindowClazz = this.getClass().forName(callBackClass);
    } catch ( Exception e ) {
      e.printStackTrace();
    }
  }
  /**
   *
   * @param title String
   * @param icon Icon
   * @param tip String
   * @param comp Component
   */
  protected void callBackOpenObjectWindow(String title,Icon icon, String tip,Component comp) {
    Object[] OArray = {title,icon,tip,comp};
    JBOFClass.CallClassMethod(callBackWindowClazz,"callBackOpenObjectWindow",OArray);
  }
  /**
   *
   * @param comp Component
   */
  protected void callBackCloseObjectWindow(Component comp) {
    Object[] OArray = {comp};
    JBOFClass.CallClassMethod(callBackWindowClazz,"callBackCloseObjectWindow",OArray);
  }
}
